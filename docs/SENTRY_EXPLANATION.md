# Sentryサービス解説

## 🔍 Sentryとは？

Sentryは**エラー監視・パフォーマンス追跡サービス**です。

### 主な機能

1. **🐛 自動エラー検知**
   - JavaScriptエラーを自動でキャッチ
   - エラーの詳細情報（スタックトレース、ブラウザ情報、ユーザー情報）を収集
   - エラー発生時にリアルタイム通知

2. **📊 エラー分析**
   - エラーの発生頻度・影響範囲を可視化
   - どのユーザーが影響を受けたか把握
   - エラーの再現手順を自動記録

3. **🚀 パフォーマンス監視**
   - ページロード時間の測定
   - APIレスポンス時間の追跡
   - ボトルネックの特定

### 具体例：Sentryがあると

**❌ Sentryなし**

```
ユーザー：「サイトが動かない！」
開発者：「え？どこで？いつ？何のエラー？」
→ 原因特定に時間がかかる
```

**✅ Sentryあり**

```
Sentry通知：「TypeError: Cannot read property 'id' of undefined」
- 発生場所：/pages/posts/[id].tsx:45
- 影響ユーザー：23人
- ブラウザ：Chrome 120
- 発生時刻：2025/09/13 14:23
→ 即座に原因特定・修正可能
```

## 💰 Sentryの料金体系

### 無料プラン（Developer Plan）

- **月5,000エラー**まで無料
- **1ユーザー**
- **30日間**のデータ保持
- 基本的な機能はすべて利用可能

**個人開発・小規模プロジェクトには十分！**

### 有料プラン

- Team：$26/月（月50,000エラー）
- Business：$80/月（月100,000エラー）
- Enterprise：要相談

### 料金計算例

```
my-board-appの場合（想定）：
- 月間アクティブユーザー：100人
- 1人あたりエラー：月2回
- 月間エラー数：200件
→ 無料プランで十分対応可能！
```

## 🔗 SentryとSlackの関係

### **独立したサービス**

**SentryとSlackは完全に独立しており、セットで設定する必要はありません。**

| 設定パターン       | 動作                             | おすすめ度 |
| ------------------ | -------------------------------- | ---------- |
| Sentryのみ         | Sentryダッシュボードでエラー確認 | ⭐⭐⭐     |
| Slackのみ          | デプロイ通知のみ                 | ⭐⭐       |
| 両方設定           | エラー即座にSlack通知            | ⭐⭐⭐⭐⭐ |
| どちらも設定しない | 問題なく動作（監視なし）         | ⭐         |

### 組み合わせ例

#### 1. Sentryのみ設定

```env
NEXT_PUBLIC_SENTRY_DSN=https://xxx.ingest.sentry.io/xxx
# SLACK_WEBHOOK_URL は設定しない
```

- エラーはSentryダッシュボードで確認
- メール通知も可能

#### 2. Slackのみ設定

```env
# NEXT_PUBLIC_SENTRY_DSN は設定しない
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx
```

- デプロイメント通知のみSlackに送信
- エラー監視はなし

#### 3. 両方設定（推奨）

```env
NEXT_PUBLIC_SENTRY_DSN=https://xxx.ingest.sentry.io/xxx
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx
```

- エラーをSentryで詳細分析
- 重要なエラーはSlackに即座通知

## 📝 設定の優先順位

### 必須度による優先順位

1. **🔴 必須**：なし（どちらも設定しなくてもアプリは動作）
2. **🟡 推奨**：Sentry（エラー監視は品質向上に重要）
3. **🟢 便利**：Slack（チーム開発時の通知共有）

### 段階的導入案

```
【Phase 1】開発初期
→ 設定なしで開発

【Phase 2】テスト段階
→ Sentryのみ設定（無料プラン）

【Phase 3】本番運用
→ Sentry + Slack設定

【Phase 4】チーム拡大
→ 有料プラン検討
```

## 🎯 my-board-appでの推奨設定

### 最小構成（コスト0円）

```env
# 何も設定しない
# アプリは正常に動作します
```

### 推奨構成（コスト0円）

```env
# Sentryのみ（無料プラン）
NEXT_PUBLIC_SENTRY_DSN=your_sentry_dsn_here
```

### 理想構成（コスト0円）

```env
# Sentry（無料）+ Slack（無料）
NEXT_PUBLIC_SENTRY_DSN=your_sentry_dsn_here
SLACK_WEBHOOK_URL=your_slack_webhook_url
```

## ❓ よくある質問

### Q: Sentryを設定しないとアプリは動かない？

**A: いいえ、問題なく動作します。** Sentryは監視ツールなので、なくてもアプリケーション自体は正常に動作します。

### Q: 後から追加できる？

**A: はい、いつでも追加可能です。** 環境変数を設定するだけで有効になります。

### Q: 無料プランで足りる？

**A: 個人開発なら十分です。** 月5,000エラーは、通常の個人プロジェクトには十分な量です。

### Q: Slackがない場合は？

**A: メール通知で代替可能です。** Sentryにはメール通知機能もあります。

### Q: 本番環境だけ設定すべき？

**A: はい、推奨します。** 開発環境では不要なエラーも記録されるため、本番環境のみの設定を推奨。

## 📊 判断フローチャート

```
アプリを公開する？
├─ いいえ → 設定不要
└─ はい
   └─ ユーザー数は？
      ├─ 10人未満 → 設定不要（オプション）
      ├─ 10-100人 → Sentry無料プラン推奨
      └─ 100人以上 → Sentry + Slack推奨
```

## 🚀 結論

- **Sentryは便利な監視ツール**だが、必須ではない
- **無料プランで十分**実用的
- **SentryとSlackは独立**しており、別々に設定可能
- **まずは設定なしで開始**し、必要に応じて追加するのがおすすめ
